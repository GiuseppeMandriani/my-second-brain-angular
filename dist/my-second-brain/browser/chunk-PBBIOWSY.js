import{a as N,b as D,c as I,d as x,e as H}from"./chunk-KMBHDENC.js";import"./chunk-BS7LHHWF.js";import{a as k}from"./chunk-D4YOEK6T.js";import{a as M}from"./chunk-3YSI55WN.js";import"./chunk-TMXYE3CE.js";import"./chunk-LEGQLTLF.js";import{a as E}from"./chunk-3WH6QEWM.js";import"./chunk-5ANNPB5B.js";import{Ia as n,Na as v,Nb as a,Sa as g,Wa as y,a as h,aa as l,b as _,fb as d,hb as C,lb as p,mb as m,nb as u,pb as f,wa as c,xb as S,zb as b}from"./chunk-72W4SQTP.js";function L(r,e){r&1&&u(0,"app-http-error",2),r&2&&d("msg","Server Error")}var T=class r{constructor(e){this.toDoService=e}http=l(E);error=c(!1);user=k(l(M).user$);nickName=a(()=>`${this.user()?.nickname}`);userTodos=c([]);totalCompleted=a(()=>this.userTodos().filter(e=>e.completed).length);totalTodos=a(()=>this.userTodos().filter(e=>!e.completed).length);ngOnInit(){this.toDoService.getTodosByNickname({nickname:this.nickName()}).subscribe({next:e=>{this.userTodos.set(e)},error:e=>{console.error("Error fetching todos:",e),this.error.set(!0)},complete:()=>{console.log("Todos fetched successfully")}})}addTodo(e){this.error.set(!1),this.toDoService.addTodo({title:e.value,completed:!1,nickname:this.nickName()}).subscribe({next:o=>{this.userTodos.update(t=>[...t,o])},error:o=>{console.error("Error fetching todos:",o),this.error.set(!0)}}),e.value=""}removeTodo(e){this.error.set(!1),e&&e.id&&this.toDoService.deleteTodo({id:e.id}).subscribe({next:()=>{this.userTodos.update(o=>o.filter(t=>t.id!==e.id))},error:o=>{console.error("Error fetching todos:",o),this.error.set(!0)}})}toggleTodo(e){this.error.set(!1),e&&e.id&&this.toDoService.updateTodo(_(h({},e),{completed:!e.completed})).subscribe({next:o=>{this.userTodos.update(t=>t.map(i=>i.id===e.id?o:i))},error:o=>{console.error("Error fetching todos:",o),this.error.set(!0)}})}saveAll(){console.log(this.userTodos)}static \u0275fac=function(o){return new(o||r)(v(H))};static \u0275cmp=g({type:r,selectors:[["app-my-todos"]],decls:7,vars:5,consts:[[1,"centered-page","sm","flex","flex-col","gap-3"],[1,"page-title"],[3,"msg"],[3,"completed","todos"],[3,"addTodo"],[3,"toggleTodo","deleteTodo","todos"]],template:function(o,t){o&1&&(p(0,"div",0)(1,"h1",1),S(2),m(),y(3,L,1,1,"app-http-error",2),u(4,"app-todos-summary",3),p(5,"app-todos-form",4),f("addTodo",function(s){return t.addTodo(s)}),m(),p(6,"app-todos-list",5),f("toggleTodo",function(s){return t.toggleTodo(s)})("deleteTodo",function(s){return t.removeTodo(s)}),m()()),o&2&&(n(2),b("Todo List nickname: ",t.nickName(),""),n(),C(t.error()?3:-1),n(),d("completed",t.totalCompleted())("todos",t.totalTodos()),n(2),d("todos",t.userTodos()))},dependencies:[x,D,I,N],encapsulation:2})};export{T as default};
