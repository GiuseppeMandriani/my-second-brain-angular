import{a as Y,b as Z}from"./chunk-5KUMPYRM.js";import{a as y}from"./chunk-LO7TS6CY.js";import{o as W,p as X}from"./chunk-IDMV7M3F.js";import"./chunk-3DYFUAHW.js";import{$a as s,Bb as I,D as H,Ea as J,Ja as V,M as A,N as C,Na as z,O as B,T as D,U as v,Wa as G,Xa as K,Ya as h,Z as R,Za as g,_a as i,a as q,ab as b,b as M,c as P,cb as S,e as F,ga as U,kb as o,lb as p,mb as Q,n as $,na as f,rb as k,sb as E,x as L,z as N,za as a,zb as x}from"./chunk-ZSQUZFEO.js";function j(t,e){let n=!e?.manualCleanup;n&&!e?.injector&&R(j);let r=n?e?.injector?.get(U)??v(U):null,u=ee(e?.equal),l;e?.requireSync?l=f({kind:0},{equal:u}):l=f({kind:1,value:e?.initialValue},{equal:u});let m=t.subscribe({next:c=>l.set({kind:1,value:c}),error:c=>{if(e?.rejectErrors)throw c;l.set({kind:2,error:c})}});if(e?.requireSync&&l().kind===0)throw new C(601,!1);return r?.onDestroy(m.unsubscribe.bind(m)),x(()=>{let c=l();switch(c.kind){case 1:return c.value;case 2:throw c.error;case 0:throw new C(601,!1)}},{equal:e?.equal})}function ee(t=Object.is){return(e,n)=>e.kind===1&&n.kind===1&&t(e.value,n.value)}function w(t){return t?.injector||R(w),I(M(q({},t),{loader:void 0,stream:e=>{let n,r=()=>n.unsubscribe();e.abortSignal.addEventListener("abort",r);let u=f({value:void 0}),l,m=new Promise(d=>l=d);function c(d){u.set(d),l?.(u),l=void 0}return n=t.loader(e).subscribe({next:d=>c({value:d}),error:d=>c({error:d}),complete:()=>{l&&c({error:new Error("Resource completed before producing a value")}),e.abortSignal.removeEventListener("abort",r)}}),m}}))}var _=class t extends Y{constructor(n,r){super(n,r,"users");this.httpClient=n}getUsers(){return this._get(this.baseUrl)}static \u0275fac=function(r){return new(r||t)(D(y),D(Z))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"})};var O=(t,e)=>e.id;function re(t,e){if(t&1&&(i(0,"li"),o(1),s()),t&2){let n=e.$implicit;a(),p(n.name)}}function ie(t,e){if(t&1&&(i(0,"li"),o(1),s()),t&2){let n=e.$implicit;a(),p(n.name)}}function se(t,e){if(t&1&&(i(0,"li"),o(1),s()),t&2){let n=e.$implicit;a(),p(n)}}function oe(t,e){t&1&&(i(0,"div"),o(1,"loading..."),s())}function ae(t,e){if(t&1&&(i(0,"li",3),o(1),s(),i(2,"p"),o(3),s()),t&2){let n=e.$implicit;a(),p(n.title),a(2),p(n.body)}}var T=class t{constructor(e){this.userService=e;this.userService.getUsers().subscribe(n=>{this.usersSignal.set(n)}),this.getUsersList()}title="";http=v(y);users=[];usersSignal=f([]);usersList=j(v(y).get("https://jsonplaceholder.typicode.com/users").pipe(H(2e3)));names=x(()=>this.usersList()?.map(e=>e.name));subscriptions=[];userId=f(1);userResource=I({request:this.userId,loader:r=>P(this,[r],function*({request:e,abortSignal:n}){return yield(yield fetch(`https://jsonplaceholder.typicode.com/users/${e}`,{signal:n})).json()})});userResourceName=w({request:this.userId,loader:({request:e})=>L({user:this.http.get(`https://jsonplaceholder.typicode.com/users/${e}`),posts:this.http.get(`https://jsonplaceholder.typicode.com/posts?userId=${e}`)})});ngOnInit(){}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}getUsersList(){this.subscriptions.push(this.userService.getUsers().pipe(A(e=>{console.log(e),e&&(this.users=e)}),N(e=>(console.error(e),$(null)))).subscribe(F))}refresh(){this.userResource.reload()}nextUser(){this.userId.update(e=>e<10?e+1:1)}prevUser(){this.userId.update(e=>e>1?e-1:10)}static \u0275fac=function(n){return new(n||t)(J(_))};static \u0275cmp=V({type:t,selectors:[["app-demo-1"]],inputs:{title:"title"},decls:41,vars:10,consts:[[1,"my-3"],[1,"flex","gap-3"],[1,"btn",3,"click"],[1,"text-2xl","my-3"]],template:function(n,r){if(n&1&&(i(0,"p"),o(1),k(2,"uppercase"),s(),b(3,"hr"),i(4,"h1",0),o(5,"HttpClient Demo"),s(),h(6,re,2,1,"li",null,O),b(8,"hr"),i(9,"h1"),o(10,"Http Signals"),s(),h(11,ie,2,1,"li",null,O),b(13,"hr"),i(14,"h1"),o(15,"Http toSignals"),s(),h(16,se,2,1,"li",null,K),b(18,"hr"),i(19,"h1"),o(20,"RESOURCE API"),s(),i(21,"h2"),o(22),s(),i(23,"div",1)(24,"button",2),S("click",function(){return r.prevUser()}),o(25,"Prev User"),s(),i(26,"button",2),S("click",function(){return r.nextUser()}),o(27,"Next User"),s()(),z(28,oe,2,0,"div"),i(29,"h1"),o(30),s(),i(31,"pre"),o(32),k(33,"json"),s(),b(34,"hr"),i(35,"h1",3),o(36),s(),h(37,ae,4,2,null,null,O),i(39,"button",2),S("click",function(){return r.refresh()}),o(40,"Refresh last data"),s()),n&2){let u,l,m;a(),p(E(2,6,r.title)),a(5),g(r.users),a(5),g(r.usersSignal()),a(5),g(r.names()),a(6),Q("Actual user ",r.userId(),""),a(6),G(r.userResource.isLoading()?28:-1),a(2),p((u=r.userResource.value())==null?null:u.name),a(2),p(E(33,8,r.userResource.value())),a(4),p((l=r.userResourceName.value())==null||l.user==null?null:l.user.name),a(),g((m=r.userResourceName.value())==null?null:m.posts)}},dependencies:[W,X],encapsulation:2})};export{T as default};
